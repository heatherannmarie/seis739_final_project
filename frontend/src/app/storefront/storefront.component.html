<h2>Store</h2>

<div class="store-grid">
    @for (item of inventory; track item.itemID) {
    <div class="store-card">
        @if (editingItem?.itemID === item.itemID) {
        <!-- Edit Mode -->
        <form (ngSubmit)="saveItemEdit()">
            <div class="form-group">
                <label>Item Name</label>
                <input type="text" [(ngModel)]="editItemName" name="editItemName" required>
            </div>
            <div class="form-group">
                <label>Price ($)</label>
                <input type="number" [(ngModel)]="editItemPrice" name="editItemPrice" min="0" step="0.01" required>
            </div>
            <div class="form-group">
                <label>Quantity</label>
                <input type="number" [(ngModel)]="editItemQuantity" name="editItemQuantity" min="0" required>
            </div>
            <div class="edit-actions">
                <button type="submit" class="save-btn">Save</button>
                <button type="button" (click)="cancelItemEdit()" class="cancel-btn">Cancel</button>
                <button type="button" (click)="deleteItem(item.itemID)" class="delete-btn">Delete</button>
            </div>
        </form>
        } @else {
        <!-- View Mode -->
        <h3>{{ item.itemName }}</h3>
        <p>Price: ${{ item.itemPrice.toFixed(2) }}</p>
        <p>In Stock: {{ item.availableInventory }}</p>
        @if (item.availableInventory > 0) {
        <span class="available">Available</span>
        @if (!isParent) {
        <button (click)="purchaseItem(item.itemID)" class="purchase-btn">Purchase</button>
        }
        } @else {
        <span class="out-of-stock">Out of Stock</span>
        }
        @if (isParent) {
        <button (click)="startItemEdit(item)" class="edit-btn">Edit</button>
        }
        }
    </div>
    }
</div>

@if (isParent) {
<form (ngSubmit)="onSubmit()" class="add-form">
    <h3>Add Item</h3>

    <div class="form-group">
        <label for="itemName">Item Name</label>
        <input type="text" id="itemName" [(ngModel)]="itemName" name="itemName" required>
    </div>

    <div class="form-group">
        <label for="itemPrice">Item Price</label>
        <input type="number" id="itemPrice" [(ngModel)]="itemPrice" name="itemPrice" min="0" step="0.01" required>
    </div>

    <div class="form-group">
        <label for="itemQuantity">Quantity</label>
        <input type="number" id="itemQuantity" [(ngModel)]="itemQuantity" name="itemQuantity" min="1" required>
    </div>

    <button type="submit" class="add-btn">Add Item</button>
</form>
}